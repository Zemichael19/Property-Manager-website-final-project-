<!DOCTYPE html>
<html>
  <%- include('../head'); -%>
  <body>
    <%- include('../navbar'); -%>
    <ul class="nav nav-tabs">
      <%_ for (const prop of properties) { -%>
        <%_ const status = (prop.id === property.id) ? 'active bg-dark' : 'inactive' -%>
      <li class="nav-item">
        <a href="/properties/edit/<%= prop.id -%>" class="nav-item nav-link text-info <%= status -%>"><%= prop.name-%></a>
      </li>
      <%_ } -%>
  </ul>

  <%_ for (const apart of apartments) { -%>
    <form id="<%= apart.id -%>" class="form-row">
      <input type="text" name="u_num" value="<%= apart.u_num -%>" class="form-control form-control-sm m-1">

      <input type="text" name="floor" value="<%= apart.floor -%>" class="form-control form-control-sm m-1">

      <input type="text" name="sqFoot" value="<%= apart.sqFoot -%>" class="form-control form-control-sm m-1">

      <input type="text" name="n_rooms" value="<%= apart.n_rooms -%>" class="form-control form-control-sm m-1">

      <input type="text" name="n_bathrooms" value="<%= apart.n_bathrooms -%>" class="form-control form-control-sm m-1">

      <input type="checkbox" name="furnished" value ="true" class="form-control mb-4" placeholder="Furnished">

      <input type="checkbox" name="laundry" value ="true" class="form-control mb-4" placeholder="Laundry">

      <input type="checkbox" name="ac" value ="true" class="form-control mb-4" placeholder="AC">

      <input type="checkbox" name="pets" value ="true" class="form-control mb-4" placeholder="Pets">

      <input type="checkbox" name="parking" value ="true" class="form-control mb-4" placeholder="Parking">

      <input type="checkbox" name="listed" value ="true" class="form-control mb-4" placeholder="Listed">

      <input type="text" name="s_date" value="<%= apart.s_date.toLocaleString().slice(0,apart.s_date.toLocaleString().indexOf(',')) -%>" class="form-control form-control-sm m-1">

      <input type="text" name="e_date" value="<%= apart.e_date.toLocaleString().slice(0,apart.e_date.toLocaleString().indexOf(',')) -%>" class="form-control form-control-sm m-1">

      <button class="update btn btn-sm btn-info m-1">Save</button>
      <button class="delete btn btn-sm btn-info m-1">Delete</button>
    </form>
  <%_ } -%>

    <div class="container-fluid">
      <div class="row">
        </div>
        <div class="col">
          <main class="p-3">
              <!--respond to button click -->
              <a href="/apartments/remove" class="btn btn-info"> Delete Apartment </a>
              <button id="delete" class="btn btn-info">Delete Property</button>


          </main>
        </div>
      </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>

      // Update a course
      $('#update').on('submit', function(event) {
        const form = $(this);
        event.preventDefault();
        $.ajax({method: 'put', url: '/properties/<%= property.id -%>', data: form.serialize()})
          .fail(error => alert(error.responseText));
      });

      // Delete a course
      $('#delete').on('click', function(event) {
        event.preventDefault();
        $.ajax({method: 'delete', url: '/properties/<%= property.id -%>'})
          .done(() => window.location.replace('/properties'))
          .fail(error => alert(error.responseText));
      });
    </script>
  </body>
</html>
